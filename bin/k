#!/usr/bin/env zsh

# default to UIUC-K
export K_VERSION=${K_VERSION:-uiuck}

# setup PATH
K_RELEASE="$SRC/k/$K_VERSION/k-distribution/target/release/k"
k_path="$K_RELEASE/lib/native/linux:$K_RELEASE/lib/native/linux64:$K_RELEASE/bin"
k_bin="$K_RELEASE/bin"

# setup LD_LIBRARY_PATH
k_ld_library_path="$K_RELEASE/lib/native/linux64"
export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$k_ld_library_path"

# setup OCaml for RV-K
[[ "$K_VERSION" == 'rvk' ]] && eval `opam config env`

# run the k* command in the setup environment
$k_bin/${0##*/} $@
